package leetcode.Six.canPartitionKSubsets;
//ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªæ­£æ•´æ•° kï¼Œæ‰¾å‡ºæ˜¯å¦æœ‰å¯èƒ½æŠŠè¿™ä¸ªæ•°ç»„åˆ†æˆ k ä¸ªéç©ºå­é›†ï¼Œå…¶æ€»å’Œéƒ½ç›¸ç­‰ã€‚
//
//
//
// ç¤ºä¾‹ 1ï¼š
//
//
//è¾“å…¥ï¼š nums = [4, 3, 2, 3, 5, 2, 1], k = 4
//è¾“å‡ºï¼š True
//è¯´æ˜ï¼š æœ‰å¯èƒ½å°†å…¶åˆ†æˆ 4 ä¸ªå­é›†ï¼ˆ5ï¼‰ï¼Œï¼ˆ1,4ï¼‰ï¼Œï¼ˆ2,3ï¼‰ï¼Œï¼ˆ2,3ï¼‰ç­‰äºæ€»å’Œã€‚
//
// ç¤ºä¾‹ 2:
//
//
//è¾“å…¥: nums = [1,2,3,4], k = 3
//è¾“å‡º: false
//
//
//
// æç¤ºï¼š
//
//
// 1 <= k <= len(nums) <= 16
// 0 < nums[i] < 10000
// æ¯ä¸ªå…ƒç´ çš„é¢‘ç‡åœ¨ [1,4] èŒƒå›´å†…
//
// Related Topics ä½è¿ç®— è®°å¿†åŒ–æœç´¢ æ•°ç»„ åŠ¨æ€è§„åˆ’ å›æº¯ çŠ¶æ€å‹ç¼© ğŸ‘ 768 ğŸ‘ 0

import java.util.Arrays;

/**
 * @Desc:
 * @Author: æ³½éœ²
 * @Date: 2022/9/20 4:32 PM
 * @Version: 1.initial version; 2022/9/20 4:32 PM
 */
public class Solution {
    public boolean canPartitionKSubsets(int[] nums, int k) {
        //å› ä¸ºé¢˜ç›®é™åˆ¶æ¡ä»¶ä¸ç”¨æ‹…å¿ƒæº¢å‡º
        int sum = 0;
        for(int i = 0; i < nums.length; i++){
            sum += nums[i];
        }
        if(sum % k != 0){
            return false;
        }
        //æ±‚å‡ºå­é›†çš„å’Œ
        sum = sum / k;
        //æ’åº å°çš„æ”¾æœ€å‰é¢å¤§çš„æ”¾æœ€åé¢
        Arrays.sort(nums);
        //å¦‚æœå­é›†çš„å’Œå°äºæ•°ç»„æœ€å¤§çš„ç›´æ¥è¿”å›false
        if(nums[nums.length - 1] > sum){
            return false;
        }
        //å»ºç«‹ä¸€ä¸ªé•¿åº¦ä¸ºkçš„æ¡¶
        int[] arr = new int[k];
        //æ¡¶çš„æ¯ä¸€ä¸ªå€¼éƒ½æ˜¯å­é›†çš„å’Œ
        Arrays.fill(arr, sum);
        //ä»æ•°ç»„æœ€åä¸€ä¸ªæ•°å¼€å§‹è¿›è¡Œé€’å½’
        return help(nums, nums.length - 1, arr, k);
    }

    boolean help(int[] nums, int cur, int[] arr, int k){
        //å·²ç»éå†åˆ°äº†-1è¯´æ˜å‰é¢çš„æ‰€æœ‰æ•°éƒ½æ­£å¥½å¯ä»¥æ”¾å…¥æ¡¶é‡Œï¼Œé‚£æ‰€æœ‰æ¡¶çš„å€¼æ­¤æ—¶éƒ½ä¸º0ï¼Œè¯´æ˜æ‰¾åˆ°äº†ç»“æœï¼Œè¿”å›true
        if(cur < 0){
            return true;
        }
        //éå†kä¸ªæ¡¶
        for(int i = 0; i < k; i++){
            //å¦‚æœæ­£å¥½èƒ½æ”¾ä¸‹å½“å‰çš„æ•°æˆ–è€…æ”¾ä¸‹å½“å‰çš„æ•°åï¼Œè¿˜æœ‰æœºä¼šç»§ç»­æ”¾å‰é¢çš„æ•°ï¼ˆå‰ªæï¼‰
            if(arr[i] == nums[cur] || (cur > 0 && arr[i] - nums[cur] >= nums[0])){
                //æ”¾å½“å‰çš„æ•°åˆ°æ¡¶ié‡Œ
                arr[i] -= nums[cur];
                //å¼€å§‹æ”¾ä¸‹ä¸€ä¸ªæ•°
                if(help(nums, cur - 1, arr, k)){
                    return true;
                }
                //è¿™ä¸ªæ•°ä¸è¯¥æ”¾åœ¨æ¡¶iä¸­
                //ä»æ¡¶ä¸­æ‹¿å›å½“å‰çš„æ•°
                arr[i] += nums[cur];
            }
        }
        return false;
    }
}
